# 音视频面经
本Notebook记录流媒体传输、计算机网络、Live相关的面经。

## 知识点
1. TCP三次握手
- 过程
  ![三次握手](https://image.fundebug.com/2019-02-27-04.png)
    1. C->S, `SYN` = 1, `Seq` = X
      表示客户端C要发起请求了。
    2. S->C, `SYN` = 1, `ACK` = X + 1, `Seq` = Y
      表示浏览器确认到请求
    3. C->S, `ACK` = Y + 1, `Seq` = X + 1
      表示握手结束，客户端开始请求

- 个人理解
  `ACK`是针对`Seq`的，且`ACK = Seq + 1`，表示`Seq x`已经被对方接收。
  `SYN`就是一个tag，表示是否是进行握手，即`SYN` = `is_syncing`。

- [为啥需要三次握手](https://blog.csdn.net/qzcsu/article/details/72861891)？
  > 一句话，主要防止已经失效的连接请求报文突然又传送到了服务器，从而产生错误。
  如果使用的是两次握手建立连接，假设有这样一种场景，**客户端发送了第一个请求连接并且没有丢失**，只是因为在网络结点中滞留的时间太长了，由于TCP的客户端迟迟没有收到确认报文，以为服务器没有收到，此时重新向服务器发送这条报文，此后客户端和服务器经过两次握手完成连接，传输数据，然后关闭连接。此时此前滞留的那一次请求连接，网络通畅了到达了服务器，这个报文本该是失效的，但是，两次握手的机制将会让客户端和服务器再次建立连接，这将导致不必要的错误和资源的浪费。
  如果采用的是三次握手，就算是那一次失效的报文传送过来了，服务端接受到了那条失效报文并且回复了确认报文，但是客户端不会再次发出确认。由于服务器收不到确认，就知道客户端并没有请求连接。

2. TCP四次挥手
当数据传送完毕，需要断开 tcp 连接，此时发起 tcp 四次挥手。
- 过程
  ![四次挥手](https://image.fundebug.com/2019-02-27-10.png)
  1. C->S, `Fin` = 1, `ACK` = Z, `Seq` = X
    提示服务器关闭连接。
  2. S->C, `ACK` = X + 1, `Seq` = Z
    表示服务器收到关闭连接请求。
  3. S->C, `Fin` = 1, `ACK` = X, `Seq` = Y
    表示响应`Seq` = X的报文发送完了，让客户端准备关闭。
  4. C->S, `Seq` = X + 1, `ACK` = Y + 1
    表示客户端接收到3的消息。

- [四次挥手通俗解释](https://blog.csdn.net/qzcsu/article/details/72861891)
  > 滴滴答答哟:按我的理解说一下3次握手跟4次挥手 3次握手就跟早期打电话时的情况一样：1、听得到吗？2、听得到，你呢？3、我也听到了。然后才开始真正对话 
  4次挥手是：1、老师，下课了。2、好，我知道了，我说完这点。3、好了，说完了，下课吧。4、谢谢老师，老师再见

## 面试题
1. [从 URL 输入到页面展现到底发生什么？](https://blog.fundebug.com/2019/02/28/what-happens-from-url-to-webpage/)
总流程：
![浏览器访问总流程](https://image.fundebug.com/2019-02-27-01.png)
  从输入URL至浏览器到访问，经历以下几个流程：
  - DNS解析：将URL解析成IP
  - TCP连接：TCP三次握手
  - 发出HTTP请求：TCP连接成功后发起请求
  - 服务器处理请求后返回HTTP报文
  - 浏览器解析报文，渲染页面
  - 断开连接：TCP四次挥手